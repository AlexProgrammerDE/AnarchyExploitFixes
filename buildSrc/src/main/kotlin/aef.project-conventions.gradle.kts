plugins {
    `java-library`
    `maven-publish`
}

var url: String? = "github.com/moom0o/AnarchyExploitFixes"

repositories {
    maven("https://repo.papermc.io/repository/maven-public/") {
        name = "papermc-repo"
    }
    maven("https://repo.dmulloy2.net/nexus/repository/public/") {
        name = "protocollib-repo"
    }
    maven("https://repo.codemc.io/repository/maven-public/") {
        name = "nbtapi-repo"
    }
    maven("https://repo.codemc.io/repository/nms/") {
        name = "nms-repo"
    }
    maven("https://ci.pluginwiki.us/plugin/repository/everything/") {
        name = "configmaster-repo"
    }
    maven("https://repo.aikar.co/content/groups/aikar/") {
        name = "aikar-repo"
    }
    maven("https://jitpack.io") {
        name = "jitpack.io"
    }

    mavenCentral()
}

dependencies {
    api("com.github.thatsmusic99:ConfigurationMaster-API:v2.0.0-rc.1") // ConfigurationMaster for enhanced config management
    api("cloud.commandframework:cloud-paper:1.8.4") // Command Framework
    api("cloud.commandframework:cloud-annotations:1.8.4")
    compileOnly("com.comphenix.protocol:ProtocolLib:5.1.0") // ProtocolLib to patch packet based exploits
    api("de.tr7zw:item-nbt-api:2.12.2") // NBT API for cross version nbt tag handling
    api("io.papermc:paperlib:1.0.8") // Useful Paper related tools
    api("org.bstats:bstats-bukkit:3.0.2") // Bukkit bStats
    api("org.apache.commons:commons-math3:3.6.1") // FastMath
    api("org.apache.commons:commons-text:1.11.0") // Apache commons text
    api("com.ibm.icu:icu4j:74.2") // Rule based number format used in first join messages to format to ordinal based on locale
}

java {
    sourceCompatibility = JavaVersion.VERSION_17
    targetCompatibility = JavaVersion.VERSION_17
}

tasks.withType<JavaCompile> {
    options.encoding = "UTF-8"
}

tasks.withType<Javadoc> {
    options.encoding = "UTF-8"
}

tasks.build.configure {
    dependsOn("shadowJar")
}

tasks {
    processResources {
        filesMatching("**/plugin.yml") {
            expand(
                "version" to project.version,
                "description" to project.description,
                "url" to url
            )
        }
    }
}

publishing {
    publications.create<MavenPublication>("maven") {
        from(components["java"])
    }
}
